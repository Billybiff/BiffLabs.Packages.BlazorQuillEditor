@namespace BiffLabs.Packages.BlazorQuillEditor.Components

@using Microsoft.JSInterop
@inject IJSRuntime JSRuntime

<div id="@EditorId"></div>

@code {
    [Parameter] public string EditorId { get; set; } = $"quill-editor-{Guid.NewGuid()}";
    [Parameter] public string Content { get; set; } = "";
    [Parameter] public object[]? ToolbarOptions { get; set; } = null;

    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
        if (firstRender)
        {
            var toolbar = ToolbarOptions ?? new object[]
            {
                new[] { "bold", "italic", "underline", "strike" },
                new[] { "blockquote", "code-block" },
                new[] { "link", "image" },
                new[] { "clean" }
            };

            await JSRuntime.InvokeVoidAsync("quillEditor.createEditor", EditorId, toolbar);
            await JSRuntime.InvokeVoidAsync("quillEditor.setEditorContent", EditorId, Content);
        }
    }

    public async Task<string> GetContentAsync()
        => await JSRuntime.InvokeAsync<string>("quillEditor.getEditorContent", EditorId);
}
